version: '3'

services:
  nginx:
    build: ./nginx
    image: nginximage 
    ports:
      - "8888:80"
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf
    depends_on:
      - node_service

  node_service:
    build: ./api
    image: nodeimage
    ports:
      - "3000:3000"
    environment:
        user: "${DB_USER}"
        password: "${DB_PASSWORD}"
        db: "${DB}"
    depends_on:
      - db 

  db:
    image: ./db
    environment:
      user: "${DB_USER}"
      password: "${DB_PASSWORD}"
      db: "${DB}"
    volumes:
      - .docker/db/init/init.sql/docker-entrypoint-initdb.d
